"use strict";var e,t,n,r,i,o,a,u,c=require("fs"),l=require("path");function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e,t,n){return(t=g(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function v(){if(r)return n;r=1;var i=c,o=l,a=t?e:(t=1,e={String:"string",string:"string",Long:"number",long:"number",Integer:"number",Double:"number",Float:"number",BigDecimal:"number",Date:"Date",LocalDateTime:"Date",LocalDate:"Date",LocalTime:"Date",Boolean:"boolean",List:"Array",Map:"object",Object:"object"}),u=Object.keys(a),s=function(){return h((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"public[^]*";f(this,e),y(this,"content",void 0),y(this,"outPath",void 0),y(this,"file_content_Regex",void 0),y(this,"dy_type",[]),this.file_content_Regex=r,this.outPath=n,this.content=this.getFileContent(t)}),[{key:"getFileContent",value:function(e){return e.match(new RegExp(this.file_content_Regex))[0].trim()}},{key:"getStrByRegex",value:function(e){var t=this.content;return e.forEach((function(e){t=t.toString().match(new RegExp(e.regex,e.mode))})),t.hasOwnProperty("groups")?t[0].trim():t}},{key:"mergeVariable",value:function(e,t,n){var r=this,i="";return e.forEach((function(e,o){i+="\t".concat(e,":  ").concat(r.typeTranslate(t[o]),"; // ").concat(n[o])+"\n\n"})),i}},{key:"typeTranslate",value:function(e){var t;if(e.includes("List")){var n=e.match(/(?<=<)\w+(?=>)/)[0];u.includes(n)?t="Array<".concat(a[n],">"):(t="Array<".concat(n,">"),this.dy_type.push(n))}else u.includes(e)?t=a[e]:(t=e,this.dy_type.push(e));return t}},{key:"outFile",value:function(e,t){var n=o.join(__dirname,this.outPath);i.mkdir(n,{recursive:!0},(function(e){}));var r=o.join(n,"".concat(e,".ts"));i.writeFile(r,t,(function(e){e?console.error("写入文件时出错:",e):console.log("TypeScript 文件写入成功")}))}},{key:"importDyType",value:function(e){if(!this.dy_type.length)return"";var t="";return this.dy_type.forEach((function(n){t+="import ".concat(n,' from "').concat(e).concat(n,'"\n')})),t}},{key:"getClassName",value:function(){return this.getStrByRegex([{regex:"(?<=class\\s)\\S(\\S*)",mode:""}])}}])}();return n=s}var p=s(function(){if(u)return a;u=1;var e=v(),t=function(){if(o)return i;o=1;var e=c,t=l;return i=function(){return h((function e(t,n){f(this,e),y(this,"content",void 0),this.handleInput(t,n)}),[{key:"handleInput",value:function(e,t){switch(e){case"string":this.content=[t];break;case"file":this.content=[this.readFile(t)];break;case"catalogue":this.content=this.readCatalogue(t);break;default:this.content=t}}},{key:"readFile",value:function(t){t=this.getPath(t);try{return e.readFileSync(t,"utf8")}catch(e){console.error("请检查你的路径是否正确\n\n",e)}}},{key:"readCatalogue",value:function(n){var r=this,i=[];n=this.getPath(n);try{e.readdirSync(n).forEach((function(e){i.push(r.readFile(t.join(n,e)))}))}catch(e){console.error("请检查你的路径是否正确\n\n",e)}return i}},{key:"isAbsolutePath",value:function(e){return/^[a-zA-Z]:\\/.test(e)||/^[a-zA-Z]:/.test(e)}},{key:"getPath",value:function(e){return this.isAbsolutePath(e)?e:t.join(__dirname,e)}}])}()}();return a=function(){return h((function n(r,i,o,a,u){var c=this;f(this,n),new t(r,i).content.forEach((function(t){c.getVariableString(new e(t,o),a,u)}))}),[{key:"getVariableString",value:function(e,t,n){var r=e.getStrByRegex(t[0].regexArr),i=e.getClassName(),o=e.mergeVariable(e.getStrByRegex(t[1].regexArr),e.getStrByRegex(t[2].regexArr),e.getStrByRegex(t[3].regexArr)),a="export default ".concat(r," {\n").concat(o,"}"),u=e.importDyType(n);e.outFile(i,u+a)}}])}()}());module.exports=p;
